webpackJsonp([84],{EwqY:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.formDiv[data-v-1f1a9936] {\n  margin-top: 1%;\n}\n.formDiv .unitForm[data-v-1f1a9936] {\n    width: 98%;\n    margin: 0 auto;\n    background-color: #fff;\n    border-radius: 6px;\n    padding: 10px 10px 0 10px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: justify;\n        -ms-flex-pack: justify;\n            justify-content: space-between;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -ms-flex-wrap: wrap;\n        flex-wrap: wrap;\n}\n.formDiv .unitForm .el-form-item .el-form-item__content .el-date-editor[data-v-1f1a9936] {\n      width: 70% !important;\n}\n.tableDiv[data-v-1f1a9936] {\n  width: 98%;\n  margin: 0 auto;\n  border-radius: 6px;\n  background-color: #fff;\n  color: #000000 !important;\n  margin-top: 1%;\n  padding: 10px 0px 10px 0px;\n}\n",""])},cjQ4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={components:{},data:function(){return{form:{name:"",status:"",timeFrame:""},totalData:[{id:1,name:"数据文件1.xlsx",file_size:12323,status:"材料齐全",update_time:"2024-10-10 11:00:00",messageList:[]},{id:2,name:"数据文件2.xlsx",file_size:234131,status:"材料不齐全",update_time:"2024-10-11 12:00:00",messageList:["数据模板2.xlsx: 工作表“其他上传数据”的第6行第8列、第4行第9列、缺少行数据","数据模板2.xlsx: 工作表“废钢预处理”的第6行第10列、第10行第10列、第1行第11列、第6行第11列、第10行第11列、行格式错误，请检查数据范围"]}],searchTableData:[{id:1,name:"数据文件1.xlsx",file_size:12323,status:"材料齐全",update_time:"2024-10-10 11:00:00",messageList:[]},{id:2,name:"数据文件2.xlsx",file_size:234131,status:"材料不齐全",update_time:"2024-10-11 12:00:00",messageList:["数据模板2.xlsx: 工作表“其他上传数据”的第6行第8列、第4行第9列、缺少行数据","数据模板2.xlsx: 工作表“废钢预处理”的第6行第10列、第10行第10列、第1行第11列、第6行第11列、第10行第11列、行格式错误，请检查数据范围"]}],TableHeight:0,tableRadio:{},currentPage:1,pagesize:10,pagesizes:[5,10,20,50,100],total:0,isopenDialog:"false",statusOptions:[{value:"材料齐全",label:"材料齐全"},{value:"材料不齐全",label:"材料不齐全"}],updateDialogVisible:!1,templateDialogVisible:!1,resDialogVisible:!1,dialogMsgList:[],checkRes:{},fileList:[]}},computed:{},watch:{},methods:{onSearch:function(){var e=this;if(""==this.form.name&&""==this.form.status&&this.form.timeFrame==[])this.$message({message:"查询不能为空",type:"error"});else{var t=this.totalData;""!=this.form.name&&(t=t.filter(function(t){return t.name.includes(e.form.name)})),""!=this.form.status&&(t=t.filter(function(t){return t.status.includes(e.form.status)})),this.form.timeFrame!=[]&&(t=t.filter(function(t){var a=new Date(t.update_time),i=new Date(e.form.timeFrame[0]),s=new Date(e.form.timeFrame[1]);return a>=i&&a<=s})),this.searchTableData=t.slice((this.currentPage-1)*this.pagesize,this.currentPage*this.pagesize),this.total=this.searchTableData.length}},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},reset:function(){this.form.name="",this.form.status="",this.timeFrame=[],this.searchTableData=this.totalData},handleCheck:function(e,t){this.dialogMsgList=t.messageList,this.resDialogVisible=!0},downLoadCheck:function(e,t){for(var a=t.messageList,i=0==a.length?"Excel中未发现错误,上传成功！！！【平台已接收】\n":"Excel中出现如下错误，请注意修改！！！【平台尚未接收】\n",s=0;s<a.length;s++)i+="  "+a[s]+"\n";var n=new Blob([i],{type:"text/plain;charset=utf-8"}),l=URL.createObjectURL(n),r=document.createElement("a");r.href=l,r.download="检查结果.txt",r.click(),URL.revokeObjectURL(l)},handleUpdate:function(e,t){this.updateDialogVisible=!0},handleDelete:function(e,t){this.searchTableData.splice(e-1,1),this.totalData=this.searchTableData,this.$message.success("删除成功")},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},downloadTemplate:function(){var e=document.createElement("a"),t=document.createEvent("MouseEvents");e.download="数据模板.xlsx",e.href="/static/data/数据模板.xlsx",t.initEvent("click",!0,!0),e.dispatchEvent(t),window.URL.revokeObjectURL(e.href)},updateFile:function(){var e=this;this.updateDialogVisible=!1,setTimeout(function(){e.checkRes!={}?(e.searchTableData.push(e.checkRes),e.totalData=e.searchTableData,e.checkRes={},e.$message.success("文件检查完毕")):e.$message.error("文件检查失败")},400)},handleSuccess:function(e,t,a){if(e&&200===e.code){var i=[];e.data.forEach(function(e){var t=e.filename+": 工作表“"+e.structuredData.sheetName[e.sheetIndex]+"”的";if("PARSE_SUCCESS"!=e.status){if("MISSING_COLUMN"==e.status)t="第"+e.missingColumnsList+"列的值缺少列数据";else if("MISSING_ROW"==e.status){var a="",s=function(t){if(0==e.missingDataList[t].length)return"continue";e.missingDataList[t].forEach(function(e){a+="第"+(e+1)+"行第"+(parseInt(t)+1)+"列、"})};for(var n in e.missingDataList)s(n);t+=a+"缺少行数据"}else if("INCORRECT_FORMAT"==e.status){var l="",r=function(t){if(0==e.errorDataList[t].length)return"continue";e.errorDataList[t].forEach(function(e){l+="第"+(e+1)+"行第"+(parseInt(t)+1)+"列、"})};for(var n in e.errorDataList)r(n);t+=l+"行格式错误，请检查数据范围"}i.push(t)}}),i.sort(function(e,t){return e.includes("缺少")&&!t.includes("缺少")?-1:!e.includes("缺少")&&t.includes("缺少")?1:0}),this.checkRes={id:this.searchTableData.length+1,name:t.name,file_size:t.size,status:0==i.length?"材料齐全":"材料不齐全",update_time:(new Date).toLocaleString(),messageList:i},this.$message.success("文件上传成功！")}else this.$message.error("文件上传失败，请重试！")},handleError:function(e,t,a){console.error("文件上传失败:",e),this.$message.error("文件上传失败，请重试！")},handleBeforeUpload:function(e){return!(this.fileList.length>=1)||(this.$message.error("只能上传一个文件"),!1)},formatFileSize:function(e){for(var t=["B","KB","MB","GB","TB","PB"],a=0;e>=1024&&a<t.length-1;)e/=1024,a++;return""+e.toFixed(2)+t[a]}},mounted:function(){var e=this;this.total=this.searchTableData.length;var t=document.documentElement.clientHeight||document.bodyclientHeight;this.$nextTick(function(){e.TableHeight=t-e.$refs.formDiv.offsetHeight-175})}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{ref:"formDiv",staticClass:"formDiv"},[a("el-form",{ref:"form",staticClass:"unitForm",attrs:{model:e.form,id:"form"}},[a("div",{staticStyle:{width:"65%",display:"flex","justify-content":"space-around"}},[a("el-form-item",{attrs:{label:"文件名称"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"上传时间:"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束"},model:{value:e.form.timeFrame,callback:function(t){e.$set(e.form,"timeFrame",t)},expression:"form.timeFrame"}})],1)],1),e._v(" "),a("div",{staticStyle:{width:"25%",display:"flex","justify-content":"center"}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.onSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"small"},on:{click:e.reset}},[e._v("重置")])],1)],1)])],1),e._v(" "),a("div",{staticClass:"tableDiv"},[a("div",{staticStyle:{display:"flex","justify-content":"right","margin-right":"2%"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-upload",size:"small"},on:{click:function(t){e.updateDialogVisible=!0}}},[e._v("上传")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"small"},on:{click:function(t){e.templateDialogVisible=!0}}},[e._v("参考模板")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-delete",size:"small"}},[e._v("删除")])],1),e._v(" "),a("el-dialog",{attrs:{title:"数据上传",visible:e.updateDialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.updateDialogVisible=t}}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.baseurl+"/upload",accept:".xlsx, .csv, .json",multiple:"","on-success":e.handleSuccess,"on-error":e.handleError,"file-list":e.fileList,"before-upload":e.handleBeforeUpload}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传excel/csv/json文件")])]),a("br"),e._v(" "),a("span",[e._v("1.上传时仅支持.excel/.csv/.json文件格式文件")]),a("br"),e._v(" "),a("span",[e._v("2.上传时请确保文件名唯一，重复上传会覆盖原有文件")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.updateDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updateFile}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"数据准备",visible:e.templateDialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.templateDialogVisible=t}}},[a("span",[e._v("下载是上报数据模板，按照模板要求填写信息，并按照要求命名文件，上传文件")]),e._v(" "),a("div",[a("span",[e._v("1.文件格式为excel/csv/json")]),a("br"),e._v(" "),a("span",[e._v("2.请按照模板中的数据进行上传检查”")]),a("br"),e._v(" "),a("span",[e._v("3.常规电流范围：0.0A~5.0A 常规电压范围：0.0V~400.0V 电量=电压*电流")]),a("br")]),e._v(" "),a("el-button",{staticStyle:{"margin-top":"4%"},attrs:{type:"primary"},on:{click:e.downloadTemplate}},[e._v("下载模板规范及样例")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.templateDialogVisible=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"96%",margin:"0 auto","border-radius":"6px"},attrs:{data:e.searchTableData.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),id:"table",stripe:"","header-row-style":{height:"60px"},"row-style":{height:"60px"},"default-sort":{prop:"update_time",order:"descending"}}},[a("el-table-column",{attrs:{type:"selection",label:"",align:"center","min-width":"8%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"序号",align:"center","min-width":"5%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"文件名称",align:"center","min-width":"10%"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件大小",align:"center","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.formatFileSize(t.row.file_size))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status.includes("不")?a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.status))]):a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"update_time",label:"上传时间",align:"center",sortable:"","min-width":"12%"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){e.handleCheck(t.$index,t.row)}}},[e._v("查看结果")]),e._v(" "),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){e.downLoadCheck(t.$index,t.row)}}},[e._v("下载文件")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除任务")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pagesizes,"page-size":e.pagesize,layout:" prev, pager, next, jumper, sizes,total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"验证消息",visible:e.resDialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.resDialogVisible=t}}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击复制")]),e._v(" "),a("div",{staticStyle:{"margin-top":"4%"}},[e._v("本次上传数据数【1】;\n                "),e.dialogMsgList.length>0?a("span",[e._v("平台成功接收数据数【0】;尚有材料缺失数据数【1】;")]):a("span",[e._v("平台成功接收数据数【1】;尚有材料缺失数据数【0】;")])]),e._v(" "),a("br"),a("br"),e._v(" "),a("div",[e._v("===================================================")]),e._v(" "),a("div",[e._v("\n                您本次上传的Excel文件中的工作表，有以下文件名称与信息汇总表中的条目匹配：\n                "),a("div",[e._v("\n                    1.若您已成功上传信息汇总表，请核对Excel表中列出的各个文件名称。确保工作表的命名在Excel表中准确无误（注意：文件名的字母大小写、特殊符号、空格等均需与Excel表中的记录完全一致）\n                ")])]),e._v(" "),a("div",{staticStyle:{color:"red"}},[a("div",{staticStyle:{margin:"2% 0"}},[e.dialogMsgList.length>0?a("span",[e._v("Excel中出现如下错误，请注意修改！！！【平台尚未接收】")]):a("span",{staticStyle:{color:"#85ce61"}},[e._v("Excel中未发现错误,上传成功！！！【平台已接收】")])]),e._v(" "),e._l(e.dialogMsgList,function(t,i){return a("div",{key:t},[t.indexOf("缺少")>-1?a("span",[e._v("  "+e._s(i+1)+"."+e._s(t))]):a("span",{staticStyle:{color:"#ebb563"}},[e._v("  "+e._s(i+1)+"."+e._s(t))])])})],2),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.resDialogVisible=!1}}},[e._v("关 闭")])],1)],1)],1)])},staticRenderFns:[]};var n=a("VU/8")(i,s,!1,function(e){a("fvVU")},"data-v-1f1a9936",null);t.default=n.exports},fvVU:function(e,t,a){var i=a("EwqY");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("4d9cfee7",i,!0)}});