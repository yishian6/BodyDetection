webpackJsonp([86],{"1osv":function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("fZjL"),n=l.n(a),i=l("uXZL"),s={name:"singleDConvert",data:function(){return{items:[{id:1,process:"化石燃料燃烧",material:"无烟煤",num:2,unit:"吨（t）",desNum:0,desUnit:"吨（t）"},{id:2,process:"化石燃料燃烧",material:"其他洗煤",num:3,unit:"吨（t）",desNum:0,desUnit:"吨（t）"},{id:3,process:"化石燃料燃烧",material:"一般煤油",num:5,unit:"吨（t）",desNum:0,desUnit:"吨（t）"},{id:4,process:"化石燃料燃烧",material:"高炉煤气",num:2,unit:"万标准立方米（万Nm³）",desNum:0,desUnit:"万标准立方米（万Nm³）"},{id:5,process:"化石燃料燃烧",material:"天然气",num:5,unit:"万标准立方米（万Nm³）",desNum:0,desUnit:"万标准立方米（万Nm³）"}],randomKey:Math.random(),processOptions:[{value:"化石燃料燃烧",label:"化石燃料燃烧"},{value:"工业生产过程",label:"工业生产过程"},{value:"净购入电力",label:"净购入电力"},{value:"固碳",label:"固碳"}],materialOptions:[],unitOptions:[],burnOptions:[{value:"无烟煤",label:"无烟煤"},{value:"烟煤",label:"烟煤"},{value:"褐煤",label:"褐煤"},{value:"洗精煤",label:"洗精煤"},{value:"其他洗煤",label:"其他洗煤"},{value:"其他煤制品",label:"其他煤制品"},{value:"焦炭",label:"焦炭"},{value:"原油",label:"原油"},{value:"燃料油",label:"燃料油"},{value:"汽油",label:"汽油"},{value:"柴油",label:"柴油"},{value:"一般煤油",label:"一般煤油"},{value:"液化天然气",label:"液化天然气"},{value:"液化石油气",label:"液化石油气"},{value:"焦炉煤气",label:"焦炉煤气"},{value:"高炉煤气",label:"高炉煤气"},{value:"转炉煤气",label:"转炉煤气"},{value:"其他煤气",label:"其他煤气"},{value:"天然气",label:"天然气"},{value:"炼厂干气",label:"炼厂干气"}],industryOptions:[{value:"石灰石净消耗量",label:"石灰石净消耗量"},{value:"白云石净消耗量",label:"白云石净消耗量"},{value:"电极净消耗量",label:"电极净消耗量"},{value:"生铁外购量",label:"生铁外购量"},{value:"直接还原铁外购量",label:"直接还原铁外购量"},{value:"镍铁合金外购量",label:"镍铁合金外购量"},{value:"铬铁合金外购量",label:"铬铁合金外购量"},{value:"铝铁合金外购量",label:"铝铁合金外购量"}],purchaseOptions:[{value:"电力净购入量",label:"电力净购入量"},{value:"热力净购入量",label:"热力净购入量"}],carbonOptions:[{value:"生铁产量",label:"生铁产量"},{value:"粗钢产量",label:"粗钢产量"},{value:"甲醇产量",label:"甲醇产量"},{value:"其他固碳产品或副产品产量",label:"其他固碳产品或副产品产量"}],tOptions:[{value:"毫克（mg）",label:"毫克（mg）"},{value:"克拉（ct）",label:"克拉（ct）"},{value:"克（g）",label:"克（g）"},{value:"千克(kg)",label:"千克(kg)"},{value:"吨（t）",label:"吨（t）"},{value:"千吨（kt）",label:"千吨（kt）"}],nmOptions:[{value:"升（L）",label:"升（L）"},{value:"标准立方米（Nm³）",label:"标准立方米（Nm³）"},{value:"千标准立方米（kNm³）",label:"千标准立方米（kNm³）"},{value:"万标准立方米（万Nm³）",label:"万标准立方米（万Nm³）"}],whOptions:[{value:"瓦时（Wh）",label:"瓦时（Wh）"},{value:"千瓦时（kWh）",label:"千瓦时（kWh）"},{value:"兆瓦时（MWh）",label:"兆瓦时（MWh）"},{value:"吉瓦时（GWh）",label:"吉瓦时（GWh）"},{value:"太瓦时（TWh）",label:"太瓦时（TWh）"}],jOptions:[{value:"焦耳（J）",label:"焦耳（J）"},{value:"千焦耳（kJ）",label:"千焦耳（kJ）"},{value:"兆焦耳（MJ）",label:"兆焦耳（MJ）"},{value:"吉焦耳（GJ）",label:"吉焦耳（GJ）"}],allMap:{"毫克（mg）":.001,"克拉（ct）":.2,"克（g）":1,"千克(kg)":1e3,"吨（t）":1e6,"千吨（kt）":1e9,"升（L）":.001,"标准立方米（Nm³）":1,"千标准立方米（kNm³）":1e3,"万标准立方米（万Nm³）":1e4,"瓦时（Wh）":.001,"千瓦时（kWh）":1,"兆瓦时（MWh）":1e3,"吉瓦时（GWh）":1e6,"太瓦时（TWh）":1e9,"焦耳（J）":.001,"千焦耳（kJ）":1,"兆焦耳（MJ）":1e3,"吉焦耳（GJ）":1e6},tempItems:[]}},methods:{editData:function(e,t){var l=this;e[t.property+"isShow"]=!0,this.refreshTable(),this.$nextTick(function(){l.$refs[t.property]&&l.$refs[t.property].focus()})},alterData:function(e,t){e[t.property+"isShow"]=!1,this.refreshTable();/^$|^[+-]?([0-9]*[.])?[0-9]+$/.test(e.num)||(e.num=0,this.$message.error("请输入数字")),""==e.num&&(e.num=0,this.$message.error("请输入数字"))},refreshTable:function(){this.randomKey=Math.random()},add:function(){this.items.push({id:this.items.length+1,process:"",material:"",num:0,unit:"",desNum:0,desUnit:""})},handleDelete:function(e){var t=this.items.findIndex(function(t){return t.id===e.id});-1!==t?(this.items.splice(t,1),this.$message({message:"删除成功",type:"success"})):this.$message({message:"删除失败",type:"error"})},convert:function(){var e=this;this.items.some(function(e){return""===e.process||""===e.material||""===e.num||""===e.unit||""===e.desUnit})?this.$message.error("请填写完整后再进行转换"):(this.items.forEach(function(t){var l=e.allMap[t.unit],a=e.allMap[t.desUnit];console.log(l,a),t.desNum=t.num*l/a}),this.$message.success("转换成功"))},visibleChange:function(e,t){t&&(["液化天然气","液化石油气","焦炉煤气","高炉煤气","转炉煤气","其他煤气","天然气","炼厂干气"].indexOf(e.material)>-1?this.unitOptions=this.nmOptions:"电力净购入量"==e.material?this.unitOptions=this.whOptions:"热力净购入量"==e.material?this.unitOptions=this.jOptions:this.unitOptions=this.tOptions)},mVisibleChange:function(e,t){t&&("化石燃料燃烧"==e.process?this.materialOptions=this.burnOptions:"工业生产过程"==e.process?this.materialOptions=this.industryOptions:"净购入电力"==e.process?this.materialOptions=this.purchaseOptions:"固碳"==e.process&&(this.materialOptions=this.carbonOptions))},changeProcess:function(e){e.material="",e.num=0,e.unit="",e.desUnit="",e.desNum=0},changeMaterial:function(e){"化石燃料燃烧"!=e.process&&"净购入电力"!=e.process||(e.unit="",e.desUnit="")},downloadExcel:function(){if(this.items.some(function(e){return""===e.process||""===e.material||""===e.num||""===e.unit||""===e.desUnit}))this.$message.error("请转换完成后再进行下载！！！");else{var e={id:"编号",process:"生产过程",material:"物料",num:"数量",unit:"单位",desNum:"目标数量",desUnit:"目标单位"},t=this.items.map(function(t){var l={};return n()(e).forEach(function(a){l[e[a]]=t[a]}),l}),l=i.utils.json_to_sheet(t),a=i.utils.book_new();i.utils.book_append_sheet(a,l,"Data");var s="量纲转换数据_"+Math.random().toString(36).substring(2,6)+".xlsx";i.writeFile(a,s)}},formatParam:function(e,t,l){return-1==String(l).indexOf(".")?parseFloat(l).toFixed(3):l}}},o={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"container"},[l("div",{staticClass:"title"},[e._v("量纲转换")]),e._v(" "),l("div",{staticClass:"operation"},[l("span",{staticStyle:{"font-size":"large"}},[e._v("转换信息")]),e._v(" "),l("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-download",type:"primary",size:"small"},on:{click:e.downloadExcel}},[e._v("下载")]),e._v(" "),l("el-button",{staticStyle:{float:"right","margin-right":"2%"},attrs:{icon:"el-icon-plus",type:"primary",size:"small"},on:{click:e.add}},[e._v("添加")])],1),e._v(" "),l("el-table",{key:e.randomKey,staticClass:"table",attrs:{data:e.items,id:"table",stripe:"","header-row-style":{height:"35px"},"row-style":{height:"35px"},"max-height":"409"},on:{"cell-dblclick":e.editData}},[l("el-table-column",{attrs:{type:"selection",label:"",align:"center","min-width":"6%"}}),e._v(" "),l("el-table-column",{attrs:{label:"生产过程",property:"process","min-width":"10%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{filterable:""},on:{change:function(l){e.changeProcess(t.row)}},model:{value:t.row.process,callback:function(l){e.$set(t.row,"process",l)},expression:"scope.row.process"}},e._l(e.processOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"材料",property:"material","min-width":"10%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{on:{"visible-change":function(l){e.mVisibleChange(t.row,l)},change:function(l){e.changeMaterial(t.row)}},model:{value:t.row.material,callback:function(l){e.$set(t.row,"material",l)},expression:"scope.row.material"}},e._l(e.materialOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"数据",property:"num","min-width":"10%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row[t.column.property+"isShow"]?l("el-input",{ref:t.column.property,on:{blur:function(l){e.alterData(t.row,t.column)}},model:{value:t.row.num,callback:function(l){e.$set(t.row,"num",l)},expression:"scope.row.num"}}):l("span",[e._v(e._s(e.formatParam(t.row,t.column,t.row.num)))])]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"源单位",property:"unit","min-width":"10%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{on:{"visible-change":function(l){e.visibleChange(t.row,l)}},model:{value:t.row.unit,callback:function(l){e.$set(t.row,"unit",l)},expression:"scope.row.unit"}},e._l(e.unitOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"结果",property:"desNum","min-width":"10%",align:"center",formatter:e.formatParam}}),e._v(" "),l("el-table-column",{attrs:{label:"目标单位",property:"desUnit","min-width":"10%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{on:{"visible-change":function(l){e.visibleChange(t.row,l)}},model:{value:t.row.desUnit,callback:function(l){e.$set(t.row,"desUnit",l)},expression:"scope.row.desUnit"}},e._l(e.unitOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"right","min-width":"4%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("i",{staticClass:"el-icon-delete delete-icon",on:{click:function(l){l.stopPropagation(),e.handleDelete(t.row)}}}),e._v("\n                   \n            ")]}}])})],1),e._v(" "),l("div",{staticClass:"convert"},[l("el-button",{staticStyle:{"margin-right":"4%"},attrs:{icon:"el-icon-video-play",type:"primary",size:"small"},on:{click:e.convert}},[e._v("转换")])],1)],1)},staticRenderFns:[]};var r=l("VU/8")(s,o,!1,function(e){l("oZM6")},"data-v-40c0cb3e",null);t.default=r.exports},"g0z+":function(e,t,l){(e.exports=l("FZ+f")(!1)).push([e.i,"\n.container[data-v-40c0cb3e] {\n  width: 90%;\n  margin: 0 auto;\n  padding: 2%;\n  background-color: #fff;\n  border-radius: 8px;\n  -webkit-box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n          box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  color: #000000;\n  margin-top: 2%;\n  padding-bottom: 4%;\n}\n.container .title[data-v-40c0cb3e] {\n    font-size: 28px;\n    font-weight: bold;\n    text-align: center;\n    margin-bottom: 4%;\n}\n.container .operation[data-v-40c0cb3e] {\n    margin-bottom: 2%;\n}\n.container .table[data-v-40c0cb3e] {\n    width: 96%;\n}\n.container .table .delete-icon[data-v-40c0cb3e] {\n      color: #f78989;\n      visibility: hidden;\n}\n.container .table tbody tr:hover .delete-icon[data-v-40c0cb3e] {\n      visibility: visible;\n      cursor: pointer;\n}\n.container .convert[data-v-40c0cb3e] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: right;\n        -ms-flex-pack: right;\n            justify-content: right;\n    margin-top: 2%;\n}\n",""])},oZM6:function(e,t,l){var a=l("g0z+");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);l("rjj0")("20a4b228",a,!0)}});